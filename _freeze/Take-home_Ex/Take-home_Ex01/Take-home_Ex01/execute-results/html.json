{
  "hash": "577ffa2b2304da3d61eb88527b7e0d35",
  "result": {
    "markdown": "---\ntitle: \"Take-home Exercise 1\"\nauthor: \"Zhang Shujie (Suzy)\"\ndate: \"January 16,2024\"\ndate-modified: \"last-modified\"\nexecute: \n  eval: true\n  echo: true\n  freeze: true\n  warning: false\nformat:\n  html:\n    code-fold: true\n    code-summary: \"Show the code\"\neditor: visual\n---\n\n\n# 1 Project Brief\n\nWhile Singapore has made strides in reducing disparities in family wealth, its education policy is committed to ensuring high-quality education in every school. However, the general public still perceives persistent educational inequalities, especially between elite and ordinary community schools, as well as among students from different socioeconomic backgrounds and immigrant families. We will delve deeply into the state of education in Singapore, based on the data provided by the 2022 Programme for International Student Assessment (PISA).\n\n# 2 Project Objectives\n\nThe aim of this project is to conduct an Exploratory Data Analysis (EDA) using the 2022 PISA data, focusing on students in Singapore. The analysis will explore `the distribution of Singaporean students' performance in mathematics, reading, and science, and examine the relationship between these performances and various factors such as school, gender, and socioeconomic status`. The analysis will be visualized effectively to communicate the findings derived from the data.\n\n# 3 Data Preparation\n\n## 3.1 Install and launching R packages\n\nWe use the `pacman::p_load()` function to load the required R packages into our working environment. The loaded packages are:\n\n-   **tidyverse**: A collection of packages for data manipulation and visualization, including ggplot2, dplyr, tidyr, etc.\n\n-   **ggplot2**: For creating complex charts and visualizations.\n\n-   **dplyr**: For data manipulation and cleaning.\n\n-   **readr**: For reading CSV files.\n\n-   **ggpubr**: Provides easy-to-use functions for creating publication-quality charts.\n\n-   **scales**: For beautifying charts, like adjusting axes.\n\n-   **lubridate**: For handling date data, if your data includes time information.\n\n-   **forcats**: For handling categorical variables, which could be useful for dealing with variables like gender and school IDs.\n\n-   **gridExtra** or **cowplot**: For arranging multiple plots on a single page.\n\n-   **corrplot**: For visualizing correlations between variables.\n\n-   **Hmisc**: Contains many functions useful for data analysis, such as descriptive statistics.\n\n-   **kableExtra**:using for creating and beautifying tables. With the kableExtra package, you can easily add titles, footnotes, change table styles, merge cells, and more.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\npacman::p_load(tidyverse, ggplot2, dplyr, readr, ggpubr,\nscales,forcats, gridExtra, corrplot, Hmisc, lubridate,knitr, kableExtra,patchwork)\n```\n:::\n\n\n::: {.alert .alert-dismissible .alert-warning}\n<button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"alert\">\n\n</button>\n\n<h4 class=\"alert-heading\">\n\nNotes\n\n</h4>\n\n<p class=\"mb-0\">\n\nThe R package intsvy allows R users to analyse PISA data among other international large-scale assessments. The use of PISA data via R requires data preparation, and intsvy offers a data transfer function to import data available in other formats directly into R. Intsvy also provides a merge function to merge the student, school, parent, teacher and cognitive databases.\n\nBut here we only consider the situation in Singapore and don't need a comparison between countries, so we don't use this package.\n\nPlease refer to the details for more information.[Instructions](https://www.oecd.org/pisa/data/httpoecdorgpisadatabase-instructions.htm)\n\n</p>\n:::\n\n## **3.2 Dataset Organization**\n\nRead 'stu_qqq_SG'file.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\nstu_qqq_SG <- read_rds(\"data/stu_qqq_SG.rds\")\n```\n:::\n\n\n### **3.2.1 Research Variable Selection**\n\nExtracting valuable variables from the original dataset because we are investigating the distribution of academic performance among Singaporean students in mathematics, reading, and science, as well as the relationship between these performances and students' schools, gender, and socio-economic status.\n\nI have extracted the following variables:\n\n-   CNTSTUID:Intl. Student ID\n\n-   CNTSCHID:Intl. School ID\n\n-   ST004D01T:Student (Standardized) Gender,1 female,2male\n\n-   ESCS:Index of economic, social and cultural status\n\n-   PV1-10MATH:Plausible Value 1-10 in Mathematics\n\n-   PV1-10READ:Plausible Value 1-10 in Reading\n\n-   PV1-10SCIE:Plausible Value 1-10 in Science\n\nThe previous table information is too cumbersome. I will extract all these variables to create a new table, making it more conducive to subsequent analysis.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\nstu_qqq_SG_01 <- stu_qqq_SG[, c(\"CNTSTUID\", \"CNTSCHID\", \"ST004D01T\", \"ESCS\",\n                             \"PV1MATH\", \"PV2MATH\", \"PV3MATH\", \"PV4MATH\", \"PV5MATH\", \n                             \"PV6MATH\", \"PV7MATH\", \"PV8MATH\", \"PV9MATH\", \"PV10MATH\", \n                             \"PV1READ\", \"PV2READ\", \"PV3READ\", \"PV4READ\", \"PV5READ\", \n                             \"PV6READ\", \"PV7READ\", \"PV8READ\", \"PV9READ\", \"PV10READ\", \n                             \"PV1SCIE\", \"PV2SCIE\", \"PV3SCIE\", \"PV4SCIE\", \"PV5SCIE\", \n                             \"PV6SCIE\", \"PV7SCIE\", \"PV8SCIE\", \"PV9SCIE\", \"PV10SCIE\")]\n\nwrite_rds(stu_qqq_SG_01,\n          \"data/stu_qqq_SG_01.rds\")\n```\n:::\n\n\n### **3.2.2 Data overview**\n\nReviewing the table to obtain an overview and understand the general situation of the data.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\nstu_qqq_SG_01 <- read_rds(\"data/stu_qqq_SG_01.rds\")\n```\n:::\n\n\n::: panel-tabset\n## **First 5 Rows**\n\n**Displaying first 5 rows using `head()`:**\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\nhead(stu_qqq_SG_01,5) %>%\n  kbl() %>%\n  kable_material() %>%\n  scroll_box(width = \"400%\", height = \"300px\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div style=\"border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:300px; overflow-x: scroll; width:400%; \"><table class=\" lightable-material\" style='font-family: \"Source Sans Pro\", helvetica, sans-serif; margin-left: auto; margin-right: auto;'>\n <thead>\n  <tr>\n   <th style=\"text-align:right;position: sticky; top:0; background-color: #FFFFFF;\"> CNTSTUID </th>\n   <th style=\"text-align:right;position: sticky; top:0; background-color: #FFFFFF;\"> CNTSCHID </th>\n   <th style=\"text-align:right;position: sticky; top:0; background-color: #FFFFFF;\"> ST004D01T </th>\n   <th style=\"text-align:right;position: sticky; top:0; background-color: #FFFFFF;\"> ESCS </th>\n   <th style=\"text-align:right;position: sticky; top:0; background-color: #FFFFFF;\"> PV1MATH </th>\n   <th style=\"text-align:right;position: sticky; top:0; background-color: #FFFFFF;\"> PV2MATH </th>\n   <th style=\"text-align:right;position: sticky; top:0; background-color: #FFFFFF;\"> PV3MATH </th>\n   <th style=\"text-align:right;position: sticky; top:0; background-color: #FFFFFF;\"> PV4MATH </th>\n   <th style=\"text-align:right;position: sticky; top:0; background-color: #FFFFFF;\"> PV5MATH </th>\n   <th style=\"text-align:right;position: sticky; top:0; background-color: #FFFFFF;\"> PV6MATH </th>\n   <th style=\"text-align:right;position: sticky; top:0; background-color: #FFFFFF;\"> PV7MATH </th>\n   <th style=\"text-align:right;position: sticky; top:0; background-color: #FFFFFF;\"> PV8MATH </th>\n   <th style=\"text-align:right;position: sticky; top:0; background-color: #FFFFFF;\"> PV9MATH </th>\n   <th style=\"text-align:right;position: sticky; top:0; background-color: #FFFFFF;\"> PV10MATH </th>\n   <th style=\"text-align:right;position: sticky; top:0; background-color: #FFFFFF;\"> PV1READ </th>\n   <th style=\"text-align:right;position: sticky; top:0; background-color: #FFFFFF;\"> PV2READ </th>\n   <th style=\"text-align:right;position: sticky; top:0; background-color: #FFFFFF;\"> PV3READ </th>\n   <th style=\"text-align:right;position: sticky; top:0; background-color: #FFFFFF;\"> PV4READ </th>\n   <th style=\"text-align:right;position: sticky; top:0; background-color: #FFFFFF;\"> PV5READ </th>\n   <th style=\"text-align:right;position: sticky; top:0; background-color: #FFFFFF;\"> PV6READ </th>\n   <th style=\"text-align:right;position: sticky; top:0; background-color: #FFFFFF;\"> PV7READ </th>\n   <th style=\"text-align:right;position: sticky; top:0; background-color: #FFFFFF;\"> PV8READ </th>\n   <th style=\"text-align:right;position: sticky; top:0; background-color: #FFFFFF;\"> PV9READ </th>\n   <th style=\"text-align:right;position: sticky; top:0; background-color: #FFFFFF;\"> PV10READ </th>\n   <th style=\"text-align:right;position: sticky; top:0; background-color: #FFFFFF;\"> PV1SCIE </th>\n   <th style=\"text-align:right;position: sticky; top:0; background-color: #FFFFFF;\"> PV2SCIE </th>\n   <th style=\"text-align:right;position: sticky; top:0; background-color: #FFFFFF;\"> PV3SCIE </th>\n   <th style=\"text-align:right;position: sticky; top:0; background-color: #FFFFFF;\"> PV4SCIE </th>\n   <th style=\"text-align:right;position: sticky; top:0; background-color: #FFFFFF;\"> PV5SCIE </th>\n   <th style=\"text-align:right;position: sticky; top:0; background-color: #FFFFFF;\"> PV6SCIE </th>\n   <th style=\"text-align:right;position: sticky; top:0; background-color: #FFFFFF;\"> PV7SCIE </th>\n   <th style=\"text-align:right;position: sticky; top:0; background-color: #FFFFFF;\"> PV8SCIE </th>\n   <th style=\"text-align:right;position: sticky; top:0; background-color: #FFFFFF;\"> PV9SCIE </th>\n   <th style=\"text-align:right;position: sticky; top:0; background-color: #FFFFFF;\"> PV10SCIE </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 70200001 </td>\n   <td style=\"text-align:right;\"> 70200052 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 0.1836 </td>\n   <td style=\"text-align:right;\"> 639.004 </td>\n   <td style=\"text-align:right;\"> 601.251 </td>\n   <td style=\"text-align:right;\"> 621.480 </td>\n   <td style=\"text-align:right;\"> 631.596 </td>\n   <td style=\"text-align:right;\"> 579.276 </td>\n   <td style=\"text-align:right;\"> 591.791 </td>\n   <td style=\"text-align:right;\"> 600.709 </td>\n   <td style=\"text-align:right;\"> 587.322 </td>\n   <td style=\"text-align:right;\"> 618.131 </td>\n   <td style=\"text-align:right;\"> 581.973 </td>\n   <td style=\"text-align:right;\"> 676.298 </td>\n   <td style=\"text-align:right;\"> 692.247 </td>\n   <td style=\"text-align:right;\"> 690.981 </td>\n   <td style=\"text-align:right;\"> 643.067 </td>\n   <td style=\"text-align:right;\"> 627.908 </td>\n   <td style=\"text-align:right;\"> 684.676 </td>\n   <td style=\"text-align:right;\"> 661.380 </td>\n   <td style=\"text-align:right;\"> 674.070 </td>\n   <td style=\"text-align:right;\"> 666.282 </td>\n   <td style=\"text-align:right;\"> 657.387 </td>\n   <td style=\"text-align:right;\"> 710.634 </td>\n   <td style=\"text-align:right;\"> 618.739 </td>\n   <td style=\"text-align:right;\"> 591.623 </td>\n   <td style=\"text-align:right;\"> 659.770 </td>\n   <td style=\"text-align:right;\"> 635.892 </td>\n   <td style=\"text-align:right;\"> 646.901 </td>\n   <td style=\"text-align:right;\"> 603.569 </td>\n   <td style=\"text-align:right;\"> 621.352 </td>\n   <td style=\"text-align:right;\"> 659.674 </td>\n   <td style=\"text-align:right;\"> 649.719 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 70200002 </td>\n   <td style=\"text-align:right;\"> 70200134 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 0.8261 </td>\n   <td style=\"text-align:right;\"> 697.191 </td>\n   <td style=\"text-align:right;\"> 754.277 </td>\n   <td style=\"text-align:right;\"> 671.940 </td>\n   <td style=\"text-align:right;\"> 657.300 </td>\n   <td style=\"text-align:right;\"> 621.126 </td>\n   <td style=\"text-align:right;\"> 655.729 </td>\n   <td style=\"text-align:right;\"> 747.934 </td>\n   <td style=\"text-align:right;\"> 694.365 </td>\n   <td style=\"text-align:right;\"> 742.732 </td>\n   <td style=\"text-align:right;\"> 656.934 </td>\n   <td style=\"text-align:right;\"> 625.585 </td>\n   <td style=\"text-align:right;\"> 686.716 </td>\n   <td style=\"text-align:right;\"> 663.147 </td>\n   <td style=\"text-align:right;\"> 567.435 </td>\n   <td style=\"text-align:right;\"> 614.500 </td>\n   <td style=\"text-align:right;\"> 604.745 </td>\n   <td style=\"text-align:right;\"> 669.375 </td>\n   <td style=\"text-align:right;\"> 623.735 </td>\n   <td style=\"text-align:right;\"> 649.579 </td>\n   <td style=\"text-align:right;\"> 571.261 </td>\n   <td style=\"text-align:right;\"> 670.646 </td>\n   <td style=\"text-align:right;\"> 748.839 </td>\n   <td style=\"text-align:right;\"> 635.443 </td>\n   <td style=\"text-align:right;\"> 639.735 </td>\n   <td style=\"text-align:right;\"> 608.385 </td>\n   <td style=\"text-align:right;\"> 670.662 </td>\n   <td style=\"text-align:right;\"> 734.807 </td>\n   <td style=\"text-align:right;\"> 639.748 </td>\n   <td style=\"text-align:right;\"> 716.768 </td>\n   <td style=\"text-align:right;\"> 655.670 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 70200003 </td>\n   <td style=\"text-align:right;\"> 70200112 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> -1.0357 </td>\n   <td style=\"text-align:right;\"> 693.710 </td>\n   <td style=\"text-align:right;\"> 654.450 </td>\n   <td style=\"text-align:right;\"> 696.938 </td>\n   <td style=\"text-align:right;\"> 646.187 </td>\n   <td style=\"text-align:right;\"> 678.119 </td>\n   <td style=\"text-align:right;\"> 644.019 </td>\n   <td style=\"text-align:right;\"> 720.531 </td>\n   <td style=\"text-align:right;\"> 671.425 </td>\n   <td style=\"text-align:right;\"> 694.085 </td>\n   <td style=\"text-align:right;\"> 668.304 </td>\n   <td style=\"text-align:right;\"> 620.116 </td>\n   <td style=\"text-align:right;\"> 559.078 </td>\n   <td style=\"text-align:right;\"> 554.767 </td>\n   <td style=\"text-align:right;\"> 587.026 </td>\n   <td style=\"text-align:right;\"> 591.806 </td>\n   <td style=\"text-align:right;\"> 570.547 </td>\n   <td style=\"text-align:right;\"> 599.078 </td>\n   <td style=\"text-align:right;\"> 545.610 </td>\n   <td style=\"text-align:right;\"> 610.466 </td>\n   <td style=\"text-align:right;\"> 590.758 </td>\n   <td style=\"text-align:right;\"> 666.095 </td>\n   <td style=\"text-align:right;\"> 604.771 </td>\n   <td style=\"text-align:right;\"> 704.217 </td>\n   <td style=\"text-align:right;\"> 687.659 </td>\n   <td style=\"text-align:right;\"> 690.974 </td>\n   <td style=\"text-align:right;\"> 617.175 </td>\n   <td style=\"text-align:right;\"> 692.886 </td>\n   <td style=\"text-align:right;\"> 630.900 </td>\n   <td style=\"text-align:right;\"> 656.620 </td>\n   <td style=\"text-align:right;\"> 649.087 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 70200004 </td>\n   <td style=\"text-align:right;\"> 70200004 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> -0.9606 </td>\n   <td style=\"text-align:right;\"> 427.317 </td>\n   <td style=\"text-align:right;\"> 410.376 </td>\n   <td style=\"text-align:right;\"> 423.586 </td>\n   <td style=\"text-align:right;\"> 388.935 </td>\n   <td style=\"text-align:right;\"> 330.962 </td>\n   <td style=\"text-align:right;\"> 379.988 </td>\n   <td style=\"text-align:right;\"> 398.535 </td>\n   <td style=\"text-align:right;\"> 422.127 </td>\n   <td style=\"text-align:right;\"> 375.354 </td>\n   <td style=\"text-align:right;\"> 453.348 </td>\n   <td style=\"text-align:right;\"> 381.495 </td>\n   <td style=\"text-align:right;\"> 400.815 </td>\n   <td style=\"text-align:right;\"> 374.911 </td>\n   <td style=\"text-align:right;\"> 367.484 </td>\n   <td style=\"text-align:right;\"> 336.009 </td>\n   <td style=\"text-align:right;\"> 324.630 </td>\n   <td style=\"text-align:right;\"> 396.242 </td>\n   <td style=\"text-align:right;\"> 374.723 </td>\n   <td style=\"text-align:right;\"> 314.704 </td>\n   <td style=\"text-align:right;\"> 342.956 </td>\n   <td style=\"text-align:right;\"> 340.308 </td>\n   <td style=\"text-align:right;\"> 329.889 </td>\n   <td style=\"text-align:right;\"> 411.353 </td>\n   <td style=\"text-align:right;\"> 327.974 </td>\n   <td style=\"text-align:right;\"> 292.183 </td>\n   <td style=\"text-align:right;\"> 355.423 </td>\n   <td style=\"text-align:right;\"> 400.182 </td>\n   <td style=\"text-align:right;\"> 317.518 </td>\n   <td style=\"text-align:right;\"> 298.893 </td>\n   <td style=\"text-align:right;\"> 362.702 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 70200005 </td>\n   <td style=\"text-align:right;\"> 70200152 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 0.0856 </td>\n   <td style=\"text-align:right;\"> 436.462 </td>\n   <td style=\"text-align:right;\"> 453.450 </td>\n   <td style=\"text-align:right;\"> 392.315 </td>\n   <td style=\"text-align:right;\"> 439.986 </td>\n   <td style=\"text-align:right;\"> 443.125 </td>\n   <td style=\"text-align:right;\"> 452.648 </td>\n   <td style=\"text-align:right;\"> 396.970 </td>\n   <td style=\"text-align:right;\"> 459.945 </td>\n   <td style=\"text-align:right;\"> 438.166 </td>\n   <td style=\"text-align:right;\"> 448.084 </td>\n   <td style=\"text-align:right;\"> 448.199 </td>\n   <td style=\"text-align:right;\"> 560.636 </td>\n   <td style=\"text-align:right;\"> 365.478 </td>\n   <td style=\"text-align:right;\"> 469.970 </td>\n   <td style=\"text-align:right;\"> 503.664 </td>\n   <td style=\"text-align:right;\"> 481.215 </td>\n   <td style=\"text-align:right;\"> 436.800 </td>\n   <td style=\"text-align:right;\"> 531.226 </td>\n   <td style=\"text-align:right;\"> 480.997 </td>\n   <td style=\"text-align:right;\"> 478.578 </td>\n   <td style=\"text-align:right;\"> 456.333 </td>\n   <td style=\"text-align:right;\"> 453.400 </td>\n   <td style=\"text-align:right;\"> 498.937 </td>\n   <td style=\"text-align:right;\"> 532.324 </td>\n   <td style=\"text-align:right;\"> 508.231 </td>\n   <td style=\"text-align:right;\"> 504.461 </td>\n   <td style=\"text-align:right;\"> 404.572 </td>\n   <td style=\"text-align:right;\"> 549.457 </td>\n   <td style=\"text-align:right;\"> 411.062 </td>\n   <td style=\"text-align:right;\"> 473.613 </td>\n  </tr>\n</tbody>\n</table></div>\n\n`````\n:::\n:::\n\n\n## **Dataset Structure**\n\n**Checking the structure of demo_data using `str()`:**\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\nstr(stu_qqq_SG_01)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\ntibble [6,606 × 34] (S3: tbl_df/tbl/data.frame)\n $ CNTSTUID : num [1:6606] 70200001 70200002 70200003 70200004 70200005 ...\n  ..- attr(*, \"label\")= chr \"Intl. Student ID\"\n $ CNTSCHID : num [1:6606] 70200052 70200134 70200112 70200004 70200152 ...\n  ..- attr(*, \"label\")= chr \"Intl. School ID\"\n $ ST004D01T: num [1:6606] 1 2 2 2 1 1 2 2 1 2 ...\n  ..- attr(*, \"label\")= chr \"Student (Standardized) Gender\"\n $ ESCS     : num [1:6606] 0.1836 0.8261 -1.0357 -0.9606 0.0856 ...\n  ..- attr(*, \"label\")= chr \"Index of economic, social and cultural status\"\n $ PV1MATH  : num [1:6606] 639 697 694 427 436 ...\n  ..- attr(*, \"label\")= chr \"Plausible Value 1 in Mathematics\"\n $ PV2MATH  : num [1:6606] 601 754 654 410 453 ...\n  ..- attr(*, \"label\")= chr \"Plausible Value 2 in Mathematics\"\n $ PV3MATH  : num [1:6606] 621 672 697 424 392 ...\n  ..- attr(*, \"label\")= chr \"Plausible Value 3 in Mathematics\"\n $ PV4MATH  : num [1:6606] 632 657 646 389 440 ...\n  ..- attr(*, \"label\")= chr \"Plausible Value 4 in Mathematics\"\n $ PV5MATH  : num [1:6606] 579 621 678 331 443 ...\n  ..- attr(*, \"label\")= chr \"Plausible Value 5 in Mathematics\"\n $ PV6MATH  : num [1:6606] 592 656 644 380 453 ...\n  ..- attr(*, \"label\")= chr \"Plausible Value 6 in Mathematics\"\n $ PV7MATH  : num [1:6606] 601 748 721 399 397 ...\n  ..- attr(*, \"label\")= chr \"Plausible Value 7 in Mathematics\"\n $ PV8MATH  : num [1:6606] 587 694 671 422 460 ...\n  ..- attr(*, \"label\")= chr \"Plausible Value 8 in Mathematics\"\n $ PV9MATH  : num [1:6606] 618 743 694 375 438 ...\n  ..- attr(*, \"label\")= chr \"Plausible Value 9 in Mathematics\"\n $ PV10MATH : num [1:6606] 582 657 668 453 448 ...\n  ..- attr(*, \"label\")= chr \"Plausible Value 10 in Mathematics\"\n $ PV1READ  : num [1:6606] 676 626 620 381 448 ...\n  ..- attr(*, \"label\")= chr \"Plausible Value 1 in Reading\"\n $ PV2READ  : num [1:6606] 692 687 559 401 561 ...\n  ..- attr(*, \"label\")= chr \"Plausible Value 2 in Reading\"\n $ PV3READ  : num [1:6606] 691 663 555 375 365 ...\n  ..- attr(*, \"label\")= chr \"Plausible Value 3 in Reading\"\n $ PV4READ  : num [1:6606] 643 567 587 367 470 ...\n  ..- attr(*, \"label\")= chr \"Plausible Value 4 in Reading\"\n $ PV5READ  : num [1:6606] 628 614 592 336 504 ...\n  ..- attr(*, \"label\")= chr \"Plausible Value 5 in Reading\"\n $ PV6READ  : num [1:6606] 685 605 571 325 481 ...\n  ..- attr(*, \"label\")= chr \"Plausible Value 6 in Reading\"\n $ PV7READ  : num [1:6606] 661 669 599 396 437 ...\n  ..- attr(*, \"label\")= chr \"Plausible Value 7 in Reading\"\n $ PV8READ  : num [1:6606] 674 624 546 375 531 ...\n  ..- attr(*, \"label\")= chr \"Plausible Value 8 in Reading\"\n $ PV9READ  : num [1:6606] 666 650 610 315 481 ...\n  ..- attr(*, \"label\")= chr \"Plausible Value 9 in Reading\"\n $ PV10READ : num [1:6606] 657 571 591 343 479 ...\n  ..- attr(*, \"label\")= chr \"Plausible Value 10 in Reading\"\n $ PV1SCIE  : num [1:6606] 711 671 666 340 456 ...\n  ..- attr(*, \"label\")= chr \"Plausible Value 1 in Science\"\n $ PV2SCIE  : num [1:6606] 619 749 605 330 453 ...\n  ..- attr(*, \"label\")= chr \"Plausible Value 2 in Science\"\n $ PV3SCIE  : num [1:6606] 592 635 704 411 499 ...\n  ..- attr(*, \"label\")= chr \"Plausible Value 3 in Science\"\n $ PV4SCIE  : num [1:6606] 660 640 688 328 532 ...\n  ..- attr(*, \"label\")= chr \"Plausible Value 4 in Science\"\n $ PV5SCIE  : num [1:6606] 636 608 691 292 508 ...\n  ..- attr(*, \"label\")= chr \"Plausible Value 5 in Science\"\n $ PV6SCIE  : num [1:6606] 647 671 617 355 504 ...\n  ..- attr(*, \"label\")= chr \"Plausible Value 6 in Science\"\n $ PV7SCIE  : num [1:6606] 604 735 693 400 405 ...\n  ..- attr(*, \"label\")= chr \"Plausible Value 7 in Science\"\n $ PV8SCIE  : num [1:6606] 621 640 631 318 549 ...\n  ..- attr(*, \"label\")= chr \"Plausible Value 8 in Science\"\n $ PV9SCIE  : num [1:6606] 660 717 657 299 411 ...\n  ..- attr(*, \"label\")= chr \"Plausible Value 9 in Science\"\n $ PV10SCIE : num [1:6606] 650 656 649 363 474 ...\n  ..- attr(*, \"label\")= chr \"Plausible Value 10 in Science\"\n```\n:::\n:::\n\n\n## **Data Health**\n\n**Checking for duplicates:**\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\nstu_qqq_SG_01[duplicated(stu_qqq_SG_01),]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 0 × 34\n# ℹ 34 variables: CNTSTUID <dbl>, CNTSCHID <dbl>, ST004D01T <dbl>, ESCS <dbl>,\n#   PV1MATH <dbl>, PV2MATH <dbl>, PV3MATH <dbl>, PV4MATH <dbl>, PV5MATH <dbl>,\n#   PV6MATH <dbl>, PV7MATH <dbl>, PV8MATH <dbl>, PV9MATH <dbl>, PV10MATH <dbl>,\n#   PV1READ <dbl>, PV2READ <dbl>, PV3READ <dbl>, PV4READ <dbl>, PV5READ <dbl>,\n#   PV6READ <dbl>, PV7READ <dbl>, PV8READ <dbl>, PV9READ <dbl>, PV10READ <dbl>,\n#   PV1SCIE <dbl>, PV2SCIE <dbl>, PV3SCIE <dbl>, PV4SCIE <dbl>, PV5SCIE <dbl>,\n#   PV6SCIE <dbl>, PV7SCIE <dbl>, PV8SCIE <dbl>, PV9SCIE <dbl>, …\n```\n:::\n:::\n\n\nFrom the output, there are no duplicated rows found in *stu_qqq_SG_01*.\n\n**Checking for missing values:**\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\nsum(is.na(stu_qqq_SG_01))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 47\n```\n:::\n:::\n\n\nFrom the output, there are `47` missing values across all columns in **stu_qqq_SG_01**.\n:::\n\n`Where is the missing value ??!!`\n\nWe found `47 missing values` in the ESCS column.\n\n::: panel-tabset\n## **The code**\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\n# Find the location of each missing value in the data set\nmissing_values_locations <- which(is.na(stu_qqq_SG_01), arr.ind = TRUE)\n\n# Display the specific column name\nmissing_values_df <- data.frame(\n  Row = missing_values_locations[, 1],\n  Column = names(stu_qqq_SG_01)[missing_values_locations[, 2]]\n)\n\n# View the location of the missing value\nprint(missing_values_df)\n```\n:::\n\n\n## **The result**\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\n    Row Column\n1    73   ESCS\n2   181   ESCS\n3   242   ESCS\n4   442   ESCS\n5   812   ESCS\n6  1152   ESCS\n7  1340   ESCS\n8  1535   ESCS\n9  1580   ESCS\n10 1647   ESCS\n11 1807   ESCS\n12 1926   ESCS\n13 1994   ESCS\n14 2027   ESCS\n15 2046   ESCS\n16 2254   ESCS\n17 2449   ESCS\n18 2463   ESCS\n19 2504   ESCS\n20 3125   ESCS\n21 3134   ESCS\n22 3163   ESCS\n23 3222   ESCS\n24 3327   ESCS\n25 3672   ESCS\n26 3902   ESCS\n27 3931   ESCS\n28 3950   ESCS\n29 4003   ESCS\n30 4154   ESCS\n31 4191   ESCS\n32 4218   ESCS\n33 4673   ESCS\n34 4708   ESCS\n35 4785   ESCS\n36 4898   ESCS\n37 5122   ESCS\n38 5555   ESCS\n39 5560   ESCS\n40 5659   ESCS\n41 5950   ESCS\n42 5990   ESCS\n43 6081   ESCS\n44 6124   ESCS\n45 6157   ESCS\n46 6196   ESCS\n47 6592   ESCS\n```\n:::\n:::\n\n:::\n\nThe Economic, Social, and Cultural Status Index (ESCS) is a **crucial indicator**, and removing observations with missing ESCS values directly may result in sample bias. `I choose to retain the missing values.`\n\n### 3.2.3 Processing PV Values\n\nDue to the presence of 10 plausible values (PVs) for performance in mathematics, reading, and science, I will take the `average PV` for each subject to facilitate subsequent EDA visualization.\n\n::: panel-tabset\n## **The result**\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 8\n  CNTSTUID CNTSCHID ST004D01T    ESCS MeanMATH MeanREAD MeanSCIE MeanOverall\n     <dbl>    <dbl>     <dbl>   <dbl>    <dbl>    <dbl>    <dbl>       <dbl>\n1 70200001 70200052         1  0.184      605.     667.     640.        637.\n2 70200002 70200134         2  0.826      690.     628.     672.        663.\n3 70200003 70200112         2 -1.04       677.     583.     660.        640.\n4 70200004 70200004         2 -0.961      401.     361.     344.        369.\n5 70200005 70200152         1  0.0856     436.     476.     479.        464.\n6 70200006 70200043         1  0.127      518.     431.     476.        475.\n```\n:::\n:::\n\n\n## **The code**\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\nstu_qqq_SG_01 <- stu_qqq_SG_01 %>%\n  rowwise() %>%\n  mutate(\n    MeanMATH = mean(c(PV1MATH, PV2MATH, PV3MATH, PV4MATH, PV5MATH, \n                      PV6MATH, PV7MATH, PV8MATH, PV9MATH, PV10MATH), na.rm = TRUE),\n    MeanREAD = mean(c(PV1READ, PV2READ, PV3READ, PV4READ, PV5READ, \n                      PV6READ, PV7READ, PV8READ, PV9READ, PV10READ), na.rm = TRUE),\n    MeanSCIE = mean(c(PV1SCIE, PV2SCIE, PV3SCIE, PV4SCIE, PV5SCIE, \n                      PV6SCIE, PV7SCIE, PV8SCIE, PV9SCIE, PV10SCIE), na.rm = TRUE),\n    MeanOverall=mean(c(PV1MATH, PV2MATH, PV3MATH, PV4MATH, PV5MATH, \n                      PV6MATH, PV7MATH, PV8MATH, PV9MATH, PV10MATH,\n                      PV1READ, PV2READ, PV3READ, PV4READ, PV5READ, \n                      PV6READ, PV7READ, PV8READ, PV9READ, PV10READ,\n                      PV1SCIE, PV2SCIE, PV3SCIE, PV4SCIE, PV5SCIE, \n                      PV6SCIE, PV7SCIE, PV8SCIE, PV9SCIE, PV10SCIE), na.rm = TRUE)\n  ) %>%\nungroup() %>%\nselect(-matches(\"^PV\\\\d+MATH$\"), -matches(\"^PV\\\\d+READ$\"), \n       -matches(\"^PV\\\\d+SCIE$\"), MeanMATH, MeanREAD, MeanSCIE,MeanOverall)\nhead(stu_qqq_SG_01)\n```\n:::\n\n:::\n\nI have now extracted the useful parts from the original table, retaining variables such as ***CNTSTUID, CNTSCHID, ST004D01T, ESCS, MeanMATH, MeanREAD, MeanSCIE, and MeanOverall***. The next step would be to conduct EDA (Exploratory Data Analysis).\n\n# 4 Exploratory Data Analysis\n\n## 4.1 Distribution of performance in math, reading and science\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstu_melted <- reshape2::melt(stu_qqq_SG_01, id.vars = \"CNTSTUID\", measure.vars = c(\"MeanMATH\", \"MeanREAD\", \"MeanSCIE\"))\n\naverage_scores <- stu_melted %>%\n  group_by(variable) %>%\n  summarise(MeanScore = mean(value, na.rm = TRUE))\n\np1 <- ggplot(stu_melted, aes(x = variable, y = value, fill = variable)) +\n  geom_boxplot(outlier.colour = \"blue\", outlier.shape = 1) +\n  geom_text(data = average_scores, aes(label = round(MeanScore, 1), y = MeanScore), \n            position = position_dodge(width = 0.75), vjust =1.8, color = \"black\", size = 3.5) +\n  stat_summary(fun.y=mean, geom=\"point\", shape=20, size=3, color=\"red\", fill=\"red\") +\n  scale_x_discrete(labels = c(\"MeanMATH\" = \"Math\", \"MeanREAD\" = \"Reading\", \"MeanSCIE\" = \"Science\")) +\n  scale_fill_brewer(palette = \"Pastel1\") +\n  labs(title = \"Distribution of subject performance value\",\n       x = \"Subject\",\n       y = \"Performance value\") +\n  theme_minimal() +\n  theme(legend.position = \"top\")\n\np2 <- ggplot(stu_qqq_SG_01, aes(x = MeanOverall)) +\n  geom_point(aes(y = MeanMATH, color = \"Math\"), alpha = 0.5) +\n  geom_smooth(aes(y = MeanMATH, color = \"Math\"), method = 'lm') +\n  geom_point(aes(y = MeanREAD, color = \"Reading\"), alpha = 0.5) +\n  geom_smooth(aes(y = MeanREAD, color = \"Reading\"), method = 'lm') +\n  geom_point(aes(y = MeanSCIE, color = \"Science\"), alpha = 0.5) +\n  geom_smooth(aes(y = MeanSCIE, color = \"Science\"), method = 'lm') +\n  scale_color_manual(values = c(\"Math\" = \"salmon\", \"Reading\" = \"steelblue1\", \"Science\" = \"darkseagreen\"),\n                     name = \"Subject\", \n                     labels = c(\"Math\" = \"Math\", \"Reading\" = \"Reading\", \"Science\" = \"Science\")) +\n  theme_minimal() +\n  theme(legend.position = \"top\") +\n  labs(title = \"Relationship Between MeanOverall and Three Subjects\",\n       x = \"MeanOverall\", y = \"Score\")\n\np1+p2\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-13-1.png){width=960}\n:::\n:::\n\n\n::: insightbox\nInsights：\n\n-   Singaporean students perform best on average in Mathematics, with Reading being the lowest.\n\n-   Reading and Science seem to have more outliers, suggesting that scores in these subjects may have more extreme cases.\n\n-   However, overall, the average scores of the three subjects are not significantly different, indicating a relatively balanced performance across subjects among Singaporean students.\n:::\n\n## 4.2 The relationship between gender and academic performance\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstu_long <- reshape2::melt(stu_qqq_SG_01, id.vars = c(\"CNTSTUID\", \"ST004D01T\"), \n                 measure.vars = c(\"MeanMATH\", \"MeanREAD\", \"MeanSCIE\",\"MeanOverall\"),\n                 variable.name = \"Subject\", value.name = \"Score\")\n\nstu_long$Subject <- factor(stu_long$Subject, \n                           levels = c(\"MeanMATH\", \"MeanREAD\", \"MeanSCIE\",\"MeanOverall\"),\n                           labels = c(\"Math\", \"Reading\", \"Science\",\"Overall\"))\n\n# Calculate the average score for each subject and gender combination\naverage_scores <- stu_long %>%\n  group_by(Subject, ST004D01T) %>%\n  summarise(AverageScore = mean(Score, na.rm = TRUE)) %>%\n  ungroup()\n\n# Plot box plots and add numerical values of average scores, using facet_wrap to arrange into a two-row and two-column layout\nggplot(stu_long, aes(x = as.factor(ST004D01T), y = Score, fill = as.factor(ST004D01T))) +\n  geom_boxplot(outlier.colour = \"red\", outlier.shape = 1) +\n  geom_text(data = average_scores, aes(label = sprintf(\"%.1f\", AverageScore), \n                                       y = AverageScore), \n            position = position_dodge(width = 0.75), \n            size = 2.5, \n            color = \"black\",\n            vjust = 1.5) +\n  facet_wrap(~ Subject, ncol = 2) + \n  labs(x = \"Gender\", y = \"Average Score\", \n       title = \"The Relationship Between Gender and Academic Performance\") +\n  scale_fill_discrete(name = \"Gender\", labels = c(\"1\" = \"Female\", \"2\" = \"Male\")) +\n  theme_minimal() +\n  theme(legend.position = \"top\")\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-14-1.png){width=768}\n:::\n:::\n\n\n::: insightbox\nInsights:\n\n-   In Mathematics and Science, boys have higher average scores than girls. In Reading, girls have higher average scores than boys.\n\n-   Across all three subjects, the distribution of boys' scores is more concentrated, suggesting they might have more consistency in their performance. In contrast, the distribution of girls' scores in Mathematics and Science is more dispersed, indicating a wider range of variability in their scores.\n\n-   Although the overall academic performance across subjects is balanced between boys and girls, girls are slightly ahead. Girls' performance across subjects appears to be more stable.\n:::\n\n## 4.3 The relationship between school and academic performance\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnumber_of_schools <- stu_qqq_SG_01 %>%\n  summarise(NumberOfSchools = n_distinct(CNTSCHID))\n\nnumber_of_schools\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1 × 1\n  NumberOfSchools\n            <int>\n1             164\n```\n:::\n:::\n\n\nThere are a total of 164 schools.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlong_data <- stu_qqq_SG_01 %>%\n  gather(key = \"Subject\", value = \"Score\", MeanMATH, MeanREAD, MeanSCIE, MeanOverall) %>%\n  group_by(CNTSCHID, Subject) %>%\n  summarise(AverageScore = mean(Score, na.rm = TRUE)) %>%\n  ungroup() %>%\n  mutate(Label = ifelse(AverageScore > 650 | AverageScore < 450, as.character(CNTSCHID), \"\"))\n\n# Create a dot plot to compare the average performance of different schools\nggplot(long_data, aes(x = CNTSCHID, y = AverageScore, color = Subject)) +\n  geom_point(position = position_dodge(width = 0.5)) +\n  geom_text(aes(label = Label), check_overlap = TRUE, vjust = -1, position = position_dodge(width = 0.5)) +\n  theme_minimal() +\n  labs(title = \"Comparison of School Performance in Subjects\",\n       x = \"School ID\", y = \"Average Score\") +\n  scale_color_brewer(palette = \"Set1\") +\n  theme(axis.text.x = element_text(angle = 90, hjust = 1)) \n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-16-1.png){width=960}\n:::\n:::\n\n\nFrom the graph, it is evident that the performance levels of most schools in Singapore are concentrated between `450 and 650`, with only a few falling outside this range. I have marked the school IDs that fall outside this range. It can be seen that the school with IDs ending in `01`、`40`、`82`、`101`、`199`、`155`shows excellent performance in all three subjects, while schools with IDs ending in `115` and `149` exhibit relatively poor performance in all three subjects.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nschool_performance <- stu_qqq_SG_01 %>%\n  group_by(CNTSCHID) %>%\n  summarise(\n    AvgMath = mean(MeanMATH, na.rm = TRUE),\n    AvgReading = mean(MeanREAD, na.rm = TRUE),\n    AvgScience = mean(MeanSCIE, na.rm = TRUE),\n    AvgOverall= mean(MeanOverall, na.rm = TRUE)\n  ) %>%\n  gather(key = \"Subject\", value = \"AverageScore\", AvgMath, AvgReading, AvgScience,AvgOverall)\n\n# Use box plots to visualize the average scores of different schools\nggplot(school_performance, aes(x = CNTSCHID, y = AverageScore, fill = Subject)) +\n  geom_boxplot() +\n  facet_wrap(~ Subject, scales = \"fixed\") +\n  theme_minimal() +\n  labs(x = \"School ID\", y = \"Average Score\", title = \"School Influence on Academic Performance\") +\n  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) \n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-17-1.png){width=768}\n:::\n:::\n\n\nFrom the box plots, it is observable that the average academic performance of most schools in Singapore lies between `500 and 600`. The majority of schools perform better in Mathematics and Science, with slightly lower performance in Reading, yet still within a reasonable range. The mean values also fall within a sensible range, with very few outliers.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Calculate the quartiles and outlier thresholds for each course in every school\nschool_quartiles <- school_performance %>%\n  group_by(CNTSCHID, Subject) %>%\n  summarise(\n    Q1 = quantile(AverageScore, 0.25, na.rm = TRUE),\n    Q3 = quantile(AverageScore, 0.75, na.rm = TRUE),\n    IQR = Q3 - Q1,\n    LowerBound = Q1 - 1.5 * IQR\n  ) %>%\n  ungroup()\n\n# Use inner_join to find outliers in the original data\noutliers <- inner_join(school_performance, school_quartiles, by = c(\"CNTSCHID\", \"Subject\")) %>%\n  filter(AverageScore < LowerBound) %>%\n  arrange(CNTSCHID, Subject)\n\n# Identify school IDs that overlap in the lower outliers for Mathematics, Reading, Science, and Overall Average Scores\noverlapping_schools <- outliers %>%\n  group_by(CNTSCHID) %>%\n  filter(n() > 1) %>%\n  arrange(CNTSCHID) %>%\n  ungroup()\n\n# Examine the overlapping outliers\noverlapping_schools\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 0 × 7\n# ℹ 7 variables: CNTSCHID <dbl>, Subject <chr>, AverageScore <dbl>, Q1 <dbl>,\n#   Q3 <dbl>, IQR <dbl>, LowerBound <dbl>\n```\n:::\n:::\n\n\nThe results show that there is no single school with outliers in the same subjects, proving that the outliers originate from different schools.\n\n::: insightbox\nInsights:\n\n-   The overall level of schools in Singapore tends to be balanced, with no significant differences and no \"extreme schools\" appearing in the high or low outliers for each subject.\n\n-   However, there is still some differentiation in subject performance levels among schools, as some schools, despite not appearing in the outliers, exhibit overall higher or lower levels in certain subjects.\n\n-   Additionally, the number of schools excelling in subject performance is greater than those performing below the average level.\n\n-   Most schools fall within a reasonable range of performance, with both strengths and weaknesses coexisting.\n:::\n\n## 4.4 The relationship between socioeconomic status and academic performance\n\nSince the three subjects and the overall average scores show a positive correlation, I have chosen to analyze the relationship between socioeconomic status and academic performance using MeanOverall and MeanSCIE.\n\n::: panel-tabset\n## **Scatter plot**\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(stu_qqq_SG_01, aes(x = ESCS)) +\n  geom_point(aes(y = MeanOverall, color = \"Overall\"), alpha = 0.5) +\n  geom_smooth(aes(y = MeanOverall, color = \"Overall\"), method = 'lm') +\n  geom_point(aes(y = MeanSCIE, color = \"Science\"), alpha = 0.5) +\n  geom_smooth(aes(y = MeanSCIE, color = \"Science\"), method = 'lm') +\n  scale_color_manual(values = c(\"Overall\" = \"lightseagreen\", \"Science\" = \"palevioletred1\"),\n                     name = \"Subject\", \n                     labels = c(\"Overall\" = \"Mean Overall\", \"Science\" = \"Mean Science\")) +\n  theme_minimal() +\n  labs(title = \"Relationship Between ESCS and Academic Performance\",\n       x = \"ESCS Index\", y = \"Score\")\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-19-1.png){width=672}\n:::\n:::\n\n\n## **Correlation test**\n\nTo determine if there is an association between the two groups, conduct a correlation analysis test.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncor_overall_escs <- cor(stu_qqq_SG_01$MeanOverall, stu_qqq_SG_01$ESCS, use = \"complete.obs\")\ncor_science_escs <- cor(stu_qqq_SG_01$MeanSCIE, stu_qqq_SG_01$ESCS, use = \"complete.obs\")\n\nlm_overall <- lm(MeanOverall ~ ESCS, data = stu_qqq_SG_01)\nlm_science <- lm(MeanSCIE ~ ESCS, data = stu_qqq_SG_01)\n\nlm_overall\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = MeanOverall ~ ESCS, data = stu_qqq_SG_01)\n\nCoefficients:\n(Intercept)         ESCS  \n     544.90        51.28  \n```\n:::\n\n```{.r .cell-code}\nlm_science\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = MeanSCIE ~ ESCS, data = stu_qqq_SG_01)\n\nCoefficients:\n(Intercept)         ESCS  \n     547.01        50.03  \n```\n:::\n:::\n\n\nThere is a significant `positive correlation` between ESCS and students' overall average scores and science scores, indicating that a higher economic, social, and cultural status is associated with better academic performance. Students who perform poorly due to unfavorable socioeconomic conditions may require some socioeconomic assistance.\n:::\n\n::: insightbox\nInsights: - Due to the positive correlation observed among the subjects, the scatter plot and correlation analysis indicate that there is a certain relationship between academic performance and socioeconomic status. Students from lower socioeconomic backgrounds tend to have poorer academic performance, while those from better socioeconomic circumstances tend to perform better academically.\n\n-   Based on these findings, recommendations can be made to Singaporean government departments and educational institutions. It is suggested to provide support and assistance to students from lower socioeconomic backgrounds to explore the possibility of improving overall academic performance. It is also possible that students from higher socioeconomic backgrounds have the opportunity to attend schools with stronger teaching capabilities.\n:::\n\n# 5 Conclusion\n\n-   **Is there a correlation in the distribution of Singaporean students' academic performance across subjects?**\n\n    Singaporean students' academic scores show a high correlation with overall performance. Schools that excel in one subject typically also excel in other subjects and overall. However, in my analysis, I did not conduct further tests. The correlation is evident from the visualization, and further validation can be done if necessary.\n\n-   **Is there a relationship between academic performance and gender?**\n\n    Indeed, there are differences in performance across subjects between male and female students. For example, boys perform better in Mathematics and Science, while girls excel in Reading. However, on average, girls show more stable overall performance. But overall, the performance between boys and girls tends to be balanced.\n\n-   **Is there a difference in performance between different schools?**\n\n    There are some differences in the performance levels of different schools, but it's not extreme. Each school has students who perform at high levels and those who perform less well, but there's no absolute good or bad.\n\n-   **Is there a relationship between academic performance and socioeconomic status (ESCS)?**\n\n    Yes, there is a significant positive correlation, indicating that students with a higher socioeconomic status perform better in Mathematics, Reading, and Science. Regression analysis shows that ESCS is an important variable in predicting academic performance, significantly impacting overall student achievement. Therefore, consideration can be given to assisting students from lower socioeconomic backgrounds.\n\nHere, I have chosen a few perspectives for analysis. Further detailed analyses, such as cluster analysis, could reveal more intrinsic phenomena.\n",
    "supporting": [
      "Take-home_Ex01_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../../site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"../../site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}